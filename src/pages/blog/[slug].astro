---
import BaseLayout from '~/layouts/BaseLayout.astro';
import type { CollectionEntry } from 'astro:content';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post }
  }));
}

interface Props {
  post: CollectionEntry<'posts'>;
}

const { post } = Astro.props as Props;
const { title, description, pubDate, tags } = post.data;
const formattedDate = new Intl.DateTimeFormat('ja-JP', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
  weekday: 'short'
}).format(pubDate);
const { Content } = await post.render();
---
<BaseLayout title={`${title} | tonoi株式会社`} description={description}>
  <article class="bg-slate-50">
    <header class="relative overflow-hidden bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 py-24 text-slate-100">
      <div class="absolute inset-x-0 -top-40 h-80 bg-[radial-gradient(circle_at_top,rgba(82,150,255,0.35),transparent_60%)]"></div>
      <div class="mx-auto max-w-3xl px-6">
        <p class="text-xs font-semibold uppercase tracking-[0.4em] text-brand-300">tonoi Notes</p>
        <h1 class="mt-6 text-4xl font-semibold md:text-5xl">{title}</h1>
        <p class="mt-4 text-base leading-relaxed text-slate-300">{description}</p>
        <div class="mt-6 flex flex-wrap items-center gap-4 text-sm text-slate-400">
          <time datetime={pubDate.toISOString()}>{formattedDate}</time>
          {tags && tags.length > 0 && (
            <div class="flex flex-wrap gap-2">
              {tags.map((tag) => (
                <span class="rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-slate-200">#{tag}</span>
              ))}
            </div>
          )}
        </div>
      </div>
    </header>
    <div class="mx-auto max-w-3xl px-6 py-16 prose prose-slate prose-h1:text-slate-900 prose-h2:text-slate-900 prose-h3:text-slate-900 prose-a:text-brand-600 prose-img:rounded-xl">
      <Content />
    </div>
  </article>
</BaseLayout>
